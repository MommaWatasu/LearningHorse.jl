<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Regression · LearningHorse</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="LearningHorse logo"/></a><div class="docs-package-name"><span class="docs-autofit">LearningHorse</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Regression</a><ul class="internal"><li><a class="tocitem" href="#Regression"><span>Regression</span></a></li></ul></li><li><a class="tocitem" href="../Classification/">Classification</a></li><li><a class="tocitem" href="../Preprocessing/">Preprocessing</a></li><li><a class="tocitem" href="../LossFunction/">LossFunction</a></li></ul></li><li><a class="tocitem" href="../Japanese/">日本語版マニュアル</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Regression</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Regression</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Regression"><a class="docs-heading-anchor" href="#Regression">Regression</a><a id="Regression-1"></a><a class="docs-heading-anchor-permalink" href="#Regression" title="Permalink"></a></h2><h3 id="How-to-use-SGD"><a class="docs-heading-anchor" href="#How-to-use-SGD">How to use SGD</a><a id="How-to-use-SGD-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-use-SGD" title="Permalink"></a></h3><p>Stochastic Gradient Descent(SGD) can be used as follows.</p><pre><code class="language-">using Horse
x = [15.43 23.01 5.0 12.56 8.67 7.31 9.66 13.64 14.92 18.47 15.48 22.1 26.95 5.68 21.76]
t = [170.91 160.68 129.0 159.7 155.46 140.56 153.65 159.43 164.7 169.71 173.29 159.31 171.52 138.96 165.87]
w = Linear_Regression.SGD.fit(x, t)
println(w) #[1.539947 136.176160] The first element is tilted and the second element is the intercept.</code></pre><p>The arguments are as follows.</p><ul><li>Linear_Regression.SGD.fit()<ul><li>x : Dependent variable</li><li>t : Objective variable</li></ul></li></ul><p>The following are keyword arguments.     - alpha : Learning rate. The default value is 0.001 	- tau_max : Maximum number of iterations. The default variable is 100000 	- eps : Absolute threshold of gradient to stop repeating. The default value is 0.1 The return value is an Array type.</p><p>Prediction using the built model can be done with the following function. However, x and w are not keyword arguments.</p><ul><li>Linear_Regression.SGD.predict()</li></ul><pre><code class="language-none">- x:Dependent variable
- w:Array of obtained by fitting</code></pre><h3 id="How-to-use-multiple-regression"><a class="docs-heading-anchor" href="#How-to-use-multiple-regression">How to use multiple regression</a><a id="How-to-use-multiple-regression-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-use-multiple-regression" title="Permalink"></a></h3><p>Multiple regression can be used as follows.</p><pre><code class="language-">using Horse
x =[15.43 23.01 5.0 12.56 8.67 7.31 9.66 13.64 14.92 18.47 15.48 22.13 10.11 26.95 5.68 21.76; 70.43 58.15 37.22 56.51 57.32 40.84 57.79 56.94 63.03 65.69 62.33 64.95 57.73 66.89 46.68 61.08]
t = [170.91 160.68 129.0 159.7 155.46 140.56 153.65 159.43 164.7 169.65 160.71 173.29 159.31 171.52 138.96 165.87]
w = Linear_Regression.MR.fit(x, t) #Here, because there is no inverse matrix, I get an error.
println(w)</code></pre><p>In multiple regression, if the inverse matrix cannot be generated in the program, the following error is returned.</p><pre><code class="language-julia">Perhaps the matrix x you passed does not have an inverse matrix. In that case, use ridge regression.</code></pre><p>As shown in the error statement, regression can be performed by using ridge regression or lasso regression, but the eigenvalue is close to 0, which makes the model unstable. Therefore, it is one way to perform processing such as deleting a row of highly correlated data.</p><p>The arguments are as follows. However, x and t are not keyword arguments.</p><ul><li>Linear_Regression.MR.fit()</li></ul><pre><code class="language-none">- x : Dependent variable
- t : Objective variable</code></pre><p>The return value is an Array type, the first element is the intercept of the model, and the subsequent elements are the coefficients of each dependent variable.</p><p>Prediction using the built model can be done with the following function. However, x and w are not keyword arguments.</p><ul><li>Linear_Regression.MR.predict()</li></ul><pre><code class="language-none">- x : Dependent variable
- w : Array of w obtained by fitting</code></pre><p>The return value is an Array type.</p><h3 id="How-to-use-Ridge-Regression"><a class="docs-heading-anchor" href="#How-to-use-Ridge-Regression">How to use Ridge Regression</a><a id="How-to-use-Ridge-Regression-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-use-Ridge-Regression" title="Permalink"></a></h3><p>Ridge regression can be used as follows.</p><pre><code class="language-">using Horse
x =[15.43 23.01 5.0 12.56 8.67 7.31 9.66 13.64 14.92 18.47 15.48 22.13 10.11 26.95 5.68 21.76; 70.43 58.15 37.22 56.51 57.32 40.84 57.79 56.94 63.03 65.69 62.33 64.95 57.73 66.89 46.68 61.08]
t = [170.91 160.68 129.0 159.7 155.46 140.56 153.65 159.43 164.7 169.65 160.71 173.29 159.31 171.52 138.96 165.87]
w = Linear_Regression.RR.fit(x, t)
#[65.47458454192515; 0.1042034860770639; 1.5756199878279644] The first element represents the intercept and the second and subsequent elements represent the coefficients of the dependent variable.
println(w)</code></pre><p>The arguments are as follows.</p><ul><li>Linear_Regression.RR.fit()</li></ul><pre><code class="language-none">- x : Dependent variable
- t : Objective variable</code></pre><p>The following are keyword arguments. 	- alpha : learning rate. The deault value is 0.1 The return value is an Array type, the first element represents the intercept of the model, and the second and subsequent elements represent the coefficients of the dependent variable.</p><p>Prediction using the built model can be done with the following function. However, x and w are not keyword arguments.</p><ul><li>Linear_Regression.RR.predict()</li></ul><pre><code class="language-none">- x : Dependent variable
- w : Array of obtained by fitting</code></pre><p>The return value is an Array type.</p><h3 id="How-to-use-Lasso-Regression"><a class="docs-heading-anchor" href="#How-to-use-Lasso-Regression">How to use Lasso Regression</a><a id="How-to-use-Lasso-Regression-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-use-Lasso-Regression" title="Permalink"></a></h3><p>Lasso regression can be used as follows.</p><pre><code class="language-">using Horse
x =[15.43 23.01 5.0 12.56 8.67 7.31 9.66 13.64 14.92 18.47 15.48 22.13 10.11 26.95 5.68 21.76; 70.43 58.15 37.22 56.51 57.32 40.84 57.79 56.94 63.03 65.69 62.33 64.95 57.73 66.89 46.68 61.08]
t = [170.91 160.68 129.0 159.7 155.46 140.56 153.65 159.43 164.7 169.65 160.71 173.29 159.31 171.52 138.96 165.87]
w = Linear_Regression.LR.fit(x, t)
# [144.61846209854855, 0.951158307335192, 0.0] The first element represents the intercept and the second and subsequent elements represent the coefficients of the dependent variable.
println(w)</code></pre><p>The arguments are as follows.</p><ul><li>Linear_Regression.LR.fit()</li></ul><pre><code class="language-none">- x : Dependent variable
- t : Objective variable</code></pre><p>The following are keyword arguments. 	- alpha : learning rate. The deault value is 0.1 	- tol : The absolute value of the error to stop repeating. The deault value is 0.0001 	- mi : Maximum number of iterations. The default value is 1000000 The return value is of type Array, the first element represents the intercept of the model, and the second and subsequent elements represent the coefficients of the dependent variable.</p><p>Prediction using the built model can be done with the following function. However, x and w are not keyword arguments.</p><ul><li>Linear_Regression.LR.predict()</li></ul><pre><code class="language-none">- x : Dependent variable
- w : Array of abstained fitting</code></pre><p>The return value is of type LinearAlgebra.Adjoint.</p><h3 id="How-to-use-basis-function-model"><a class="docs-heading-anchor" href="#How-to-use-basis-function-model">How to use basis function model</a><a id="How-to-use-basis-function-model-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-use-basis-function-model" title="Permalink"></a></h3><p>The basis function model can be used as follows.</p><pre><code class="language-">using LearningHorse
 x =[15.43 23.01 5.0 12.56 8.67 7.31 9.66 13.64 14.92 18.47 15.48 22.13 10.11 26.95 5.68 21.76; 70.43 58.15 37.22 56.51 57.32 40.84 57.79 56.94 63.03 65.69 62.33 64.95 57.73 66.89 46.68 61.08]
t = [170.91 160.68 129.0 159.7 155.46 140.56 153.65 159.43 164.7 169.65 160.71 173.29 159.31 171.52 138.96 165.87]

#Use Gaussian basis functions
w, m, s = LinearRegression.BFM.fit(x[1, :], t, 4)
println(&quot;w:&quot;, w, &quot;m:&quot;, m, &quot;s:&quot;, s)
#w:[-10.6733; 65.4475; -17.7623; 66.6557; 104.918]m:Any[5, 12.3333, 19.6667, 27.0]s:7.333333333333333

p = LinearRegression.BFM.predict(x[1, :], w, m, s)
println(p)
#[165.07, 168.55, 132.278, 162.546, 150.433, 144.04, 154.507, 164.011, 164.902, 165.417, 165.082, 167.712, 156.153, 169.583, 135.749, 167.366]

#Use polynomial basis functions
w, m, s = LinearRegression.BFM.fit(x[1, :], t, 4, alpha = 0.1, f = &quot;polynomial&quot;)
println(&quot;w, m, s(polynomial):&quot;, w, m, s)
#w, m, s(polynomial):[30.074721512969795; 17.649472753936088; -0.9665443355191238; 0.01733639801805678; 30.074721512971067]Any[5, 12.333333333333332, 19.666666666666664, 26.999999999999996]7.333333333333333

p = LinearRegression.BFM.predict(x[1, :], w, m, s, f = &quot;polynomial&quot;)
println(&quot;p(polynomial):&quot;, p)
#p(polynomial):[166.04905485192677, 165.72435351634755, 126.40024815990033, 163.70105505929791, 151.81467689141562, 144.29063632133014, 156.07721189214902, 165.05792844782184, 165.89978336872304, 165.6418324683704, 166.05887282906252, 165.26960817342376,157.70790163159944, 173.13926201582598, 132.39231072417851, 165.16779149696566]</code></pre><p>The only functions are predict and fit, but you can use two models, the polynomial regression and the Gaussian basis function model, by specifying the keyword argument f. The arguments are as follows.</p><p>Function to learn.</p><ul><li>LinearRegression.BFM.fit()</li></ul><pre><code class="language-none">- x : Dependent variable vector (matrix cannot be included) 
- t : Objective variable vector (matrix cannot be included)
- M : Set the number of dimensions to fit, for example M = 2 for 2 dimensions.</code></pre><p>The following are keyword arguments. 	- m : It can be specified for Gaussian basis functions. By default it uses the center vector of each Gaussian function 	- s : Like m, it can be specified for Gaussian functions. The default is to use a scalar that represents the spacing of each Gaussian function. 	- alpha : The coefficient applied to the regularization term that is added when calculating the design matrix. The default value is 0.0 	- f : Specify the type of basis function, pass the string &quot;gauss&quot; for Gaussian functions, or &quot;polynomial&quot; for polynomial regression. Note that the default value is &quot;gauss&quot;</p><p>Function to predict</p><ul><li>LinearRegression.BFM.predict()</li></ul><pre><code class="language-none">- x : The vector of the dependent variable used for the prediction
- w : Pass w of Array of the model obtained by fitting</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../Classification/">Classification »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 14 February 2021 08:43">Sunday 14 February 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
